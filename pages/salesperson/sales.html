<!--
=========================================================
* Soft UI Dashboard 3 - v1.1.0
=========================================================

* Product Page: https://www.creative-tim.com/product/soft-ui-dashboard
* Copyright 2024 Creative Tim (https://www.creative-tim.com)
* Licensed under MIT (https://www.creative-tim.com/license)
* Coded by Creative Tim

=========================================================

* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
-->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="apple-touch-icon" sizes="76x76" href="../../assets/img/apple-icon.png">
  <link rel="icon" type="image/png" href="../../assets/img/favicon.png">
  <title>
    Sales
  </title>
  <!--     Fonts and icons     -->
  <link href="https://fonts.googleapis.com/css?family=Inter:300,400,500,600,700,800" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />

  <!-- Nucleo Icons -->
  <link href="https://demos.creative-tim.com/soft-ui-dashboard/assets/css/nucleo-icons.css" rel="stylesheet" />
  <link href="https://demos.creative-tim.com/soft-ui-dashboard/assets/css/nucleo-svg.css" rel="stylesheet" />
  <!-- Font Awesome Icons -->
  <script src="https://kit.fontawesome.com/42d5adcbca.js" crossorigin="anonymous"></script>
  <!-- CSS Files -->
  <link id="pagestyle" href="../../assets/css/soft-ui-dashboard.css?v=1.1.0" rel="stylesheet" />
  <!-- Nepcha Analytics (nepcha.com) -->
  <!-- Nepcha is a easy-to-use web analytics. No cookies and fully compliant with GDPR, CCPA and PECR. -->
  <script defer data-site="YOUR_DOMAIN_HERE" src="https://api.nepcha.com/js/nepcha-analytics.js"></script>
  
  <style>
    /* Fix pagination display */
    .pagination {
      flex-wrap: nowrap;
    }
    
    .pagination .page-link {
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 32px;
      padding: 0.375rem 0.75rem;
    }
    
    #currentPageInfo {
      min-width: 100px;
      white-space: nowrap;
      text-align: center;
      display: inline-block;
    }
    
    .pagination-sm .page-link {
      font-size: 0.875rem;
      line-height: 1.5;
    }
  </style>
  <style>
  #topRequestedItemsTableBody {
    display: block;
    max-height: 200px;
    overflow-y: auto;
  }
  #topRequestedItemsTableBody tr {
    display: table;
    width: 100%;
    table-layout: fixed;
  }
  
  /* Responsive table styles for Sales History, Inventory Items, and Secondary Inventory */
  .table-responsive {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
  }
  
  /* Ensure tables maintain proper spacing on mobile */
  @media (max-width: 768px) {
    .table-responsive {
      border: 1px solid #dee2e6;
      border-radius: 0.375rem;
    }
    
    .table-responsive table {
      margin-bottom: 0;
      min-width: 600px; /* Ensure table doesn't get too compressed */
    }
    
    /* Improve button layout on mobile for Sales History */
    .card-body .d-flex.justify-content-end {
      flex-direction: column;
      align-items: stretch !important;
    }
    
    .card-body .d-flex.justify-content-end .btn {
      margin-bottom: 0.5rem;
      width: 100%;
    }
    
    /* Improve button layout for Inventory sections */
    .card-body .row .col-6:last-child {
      margin-top: 0.5rem;
    }
    
    .card-body .row .col-6:last-child .btn {
      margin-bottom: 0.25rem;
      width: 100%;
    }
    
    .card-body .row .col-6:last-child .input-group {
      width: 100% !important;
      margin-bottom: 0.5rem;
    }
  }
  
  /* For very small screens, make buttons stack vertically */
  @media (max-width: 576px) {
    .card-body .row .col-6:last-child {
      text-align: left !important;
    }
    
    .card-body .row .col-6:last-child .btn {
      display: block;
      width: 100%;
      margin-bottom: 0.5rem;
    }
    
    .card-body .row .col-6:last-child .input-group {
      width: 100% !important;
      margin-bottom: 0.5rem;
    }
    
    /* Make pagination more mobile-friendly */
    .d-flex.justify-content-between {
      flex-direction: column;
      align-items: center !important;
    }
    
    .d-flex.justify-content-between .text-sm {
      margin-bottom: 0.5rem;
      text-align: center;
    }
  }
  </style>
</head>

<body class="g-sidenav-show  bg-gray-100">
  <script src="../../assets/js/config.js"></script> 
  <script>
    // Redirect to sign-in if not authenticated
    (function() {
      var token = localStorage.getItem('authToken');
      console.log('[DEBUG] Token in sales.html:', token); // Debug: print token value
      if (!token) {
        window.location.href = '../sign-in.html';
      }
    })();
  </script>
  <aside class="sidenav navbar navbar-vertical navbar-expand-xs border-0 border-radius-xl my-3 fixed-start ms-3 " id="sidenav-main">
    <div class="sidenav-header">
      <i class="fas fa-times p-3 cursor-pointer text-secondary opacity-5 position-absolute end-0 top-0 d-none d-xl-none" aria-hidden="true" id="iconSidenav"></i>
      <a class="navbar-brand m-0"  target="_blank">
        
        <span class="ms-1 font-weight-bold">Sales Person Dashboard</span>
      </a>
    </div>
    <hr class="horizontal dark mt-0">
    <div class="collapse navbar-collapse  w-auto " id="sidenav-collapse-main">
      <ul class="navbar-nav">
        
        <li class="nav-item">
          <a class="nav-link active" href="../salesperson/sales.html">
            <div class="icon icon-shape icon-sm shadow border-radius-md bg-white text-center me-2 d-flex align-items-center justify-content-center">
              <i class="fas fa-chart-line text-dark"></i>
            </div>
            <span class="nav-link-text ms-1">Sales</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../salesperson/credit-management.html">
            <div class="icon icon-shape icon-sm shadow border-radius-md bg-white text-center me-2 d-flex align-items-center justify-content-center">
              <i class="fas fa-credit-card text-dark"></i>
            </div>
            <span class="nav-link-text ms-1">Credit Management</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../salesperson/credit-customers.html">
            <div class="icon icon-shape icon-sm shadow border-radius-md bg-white text-center me-2 d-flex align-items-center justify-content-center">
              <i class="fas fa-users text-dark"></i>
            </div>
            <span class="nav-link-text ms-1">Credit Customers</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../salesperson/customer-requests.html">
            <div class="icon icon-shape icon-sm shadow border-radius-md bg-white text-center me-2 d-flex align-items-center justify-content-center">
              <i class="fas fa-user-tag text-dark"></i>
            </div>
            <span class="nav-link-text ms-1">Customer Requests</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../salesperson/expenses_clean.html">
            <div class="icon icon-shape icon-sm shadow border-radius-md bg-white text-center me-2 d-flex align-items-center justify-content-center">
              <i class="fas fa-money-bill-wave text-dark"></i>
            </div>
            <span class="nav-link-text ms-1">Expenses</span>
          </a>
        </li>
      </ul>
    </div>
  </aside>
  <main class="main-content position-relative max-height-vh-100 h-100 border-radius-lg ">
    <!-- Navbar -->
    <nav class="navbar navbar-main navbar-expand-lg px-0 mx-4 shadow-none border-radius-xl" id="navbarBlur" navbar-scroll="true">
      <div class="container-fluid py-1 px-3">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb bg-transparent mb-0 pb-0 pt-1 px-0 me-sm-6 me-5">
            <li class="breadcrumb-item text-sm"><a class="opacity-5 text-dark" href="javascript:;">Pages</a></li>
            <li class="breadcrumb-item text-sm text-dark active" aria-current="page">Sales</li>
          </ol>
          <h6 class="font-weight-bolder mb-0">Sales</h6>
        </nav>
        <div class="collapse navbar-collapse mt-sm-0 mt-2 me-md-0 me-sm-4" id="navbar">
          <div class="ms-md-auto pe-md-3 d-flex align-items-center">
            <div class="input-group">
              
            </div>
          </div>
          <ul class="navbar-nav  justify-content-end">
            <li class="nav-item d-flex align-items-center">
              <a href="javascript:;" id="signOutLink" class="nav-link text-body font-weight-bold px-0">
                <i class="fa fa-user me-sm-1"></i>
                <span class="d-sm-inline d-none">Sign Out</span>
              </a>
            </li>
            <li class="nav-item d-xl-none ps-3 d-flex align-items-center">
              <a href="javascript:;" class="nav-link text-body p-0" id="iconNavbarSidenav">
                <div class="sidenav-toggler-inner">
                  <i class="sidenav-toggler-line"></i>
                  <i class="sidenav-toggler-line"></i>
                  <i class="sidenav-toggler-line"></i>
                </div>
              </a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <!-- End Navbar -->
    <div class="container-fluid py-4">
      <!-- Sales Overview Section -->
      <div class="row">
        <div class="col-12">
          <div class="card mb-4">
            <div class="card-header pb-0">
              <h6>Sales Overview</h6>
            </div>
          </div>
        </div>
      </div>

      <!-- Sales History Section -->
      <div class="row">
        <div class="col-12">
          <div class="card mb-4">
            <div class="card-header pb-0">
              <div class="row">
                <div class="col-lg-6 col-7">
                  <h6>Sales History</h6>
                  <p class="text-sm mb-0">
                    <i class="fa fa-info-circle text-info" aria-hidden="true"></i>
                    <span class="font-weight-bold ms-1">View and manage all sales transactions</span>
                  </p>
                </div>
              </div>
            </div>
            <div class="card-body px-0 pb-2">
              <div class="d-flex flex-column flex-md-row justify-content-md-end align-items-stretch align-items-md-center px-4 py-3 gap-2">
                <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#addNewSaleModal" >
                  <i class="fas fa-plus me-2"></i>Add New Sale
                </button>
                
                <button class="btn btn-outline-secondary btn-sm" id="exportSalesHistoryBtn">
                  <i class="fas fa-file-export me-2"></i>Export
                </button>
              </div>
              <div class="table-responsive">
                <table class="table align-items-center mb-0" id="salesHistoryTable">
                  <thead>
                    <tr>
                      <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Customer</th>
                      <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Items</th>
                      <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Date</th>
                      <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Total</th>
                      <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Action</th>
                    </tr>
                  </thead>
                  <tbody id="salesHistoryTableBody">
                    <!-- Sales data will be loaded here dynamically -->
                  </tbody>
                </table>
                          </div>
              
              <!-- Pagination Controls -->
              <div class="d-flex justify-content-between align-items-center mt-3 px-4">
                <div class="text-sm text-muted">
                  Showing <span id="startRecord">0</span> to <span id="endRecord">0</span> of <span id="totalRecords">0</span> sales
                        </div>
                <div class="d-flex align-items-center">
                  <button class="btn btn-sm btn-outline-secondary me-2" id="prevPage" onclick="previousPage()" disabled>
                    <i class="fas fa-chevron-left"></i>
                        </button>
                  <span class="badge bg-primary px-3 py-2" id="currentPageInfo">Page 1</span>
                  <button class="btn btn-sm btn-outline-secondary ms-2" id="nextPage" onclick="nextPage()" disabled>
                    <i class="fas fa-chevron-right"></i>
                  </button>
                          </div>
                        </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Inventory Items Section (Original) -->
      <div class="row">
        <div class="col-12">
          <div class="card mb-4">
            <div class="card-header pb-0">
              <h4>Inventory Items</h4>
              <p class="text-sm text-secondary mb-0">Manage your store's Inventory items and stock levels</p>
            </div>
            <div class="card-body">
              <!-- Action Buttons -->
              <div class="row mb-4">
                <div class="col-12 col-md-6">
                  <button class="btn bg-gradient-primary w-100 w-md-auto" data-bs-toggle="modal" data-bs-target="#addNewItemModal">
                    <i class="fas fa-plus me-2"></i>Add New Item
                  </button>
                </div>
                <div class="col-12 col-md-6 mt-2 mt-md-0">
                  <div class="d-flex flex-column flex-md-row gap-2">
                    <div class="input-group input-group-outline" style="height: 45px;">
                      <span class="input-group-text"><i class="fas fa-search"></i></span>
                      <input type="text" class="form-control" placeholder="Search Item">
                    </div>
                    <button class="btn bg-gradient-secondary" id="exportInventoryBtn">
                      <i class="fas fa-file-export me-2"></i>Export
                    </button>
                  </div>
                </div>
              </div>

              <!-- Category Selection -->
              <div class="row mb-4">
                <div class="col-12">
                  <div class="nav-wrapper position-relative end-0">
                    <ul class="nav nav-pills nav-fill p-1" role="tablist">
                      <li class="nav-item">
                        <a class="nav-link mb-0 px-0 py-1 active" data-bs-toggle="tab" href="#weighable" role="tab" aria-controls="weighable" aria-selected="true">
                          <span class="ms-1">Weighable Goods</span>
                        </a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link mb-0 px-0 py-1" data-bs-toggle="tab" href="#unit" role="tab" aria-controls="unit" aria-selected="false">
                          <span class="ms-1">Unit-Based Goods</span>
                        </a>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>

              <!-- Tab Content -->
              <div class="tab-content">
                <!-- Weighable Goods Tab -->
                <div class="tab-pane fade show active" id="weighable" role="tabpanel">
                  <h5 class="mb-2">Weighable Goods Inventory</h5>
                  <p class="text-sm text-secondary mb-3">Manage Items sold by weight</p>
                  <div class="table-responsive p-0">
                    <table class="table align-items-center mb-0">
                      <thead>
                        <tr>
                          <th>Item</th>
                          <th>Available Quantity</th>
                          <th>Base Unit</th>
                          <th>Selling Price/Unit</th>
                          <th>Status</th>
                          <th>Action</th>
                        </tr>
                      </thead>
                      <tbody id="weighableItemsTableBody"></tbody>
                    </table>
                    <div class="d-flex justify-content-between align-items-center mt-3 px-4" id="weighablePaginationControls">
                      <div class="text-sm text-muted">
                        Showing <span id="weighableStartRecord">0</span> to <span id="weighableEndRecord">0</span> of <span id="weighableTotalRecords">0</span> items
                      </div>
                      <div class="d-flex align-items-center">
                        <button class="btn btn-sm btn-outline-secondary me-2" id="weighablePrevPage" disabled>
                          <i class="fas fa-chevron-left"></i>
                        </button>
                        <span class="badge bg-primary px-3 py-2" id="weighableCurrentPageInfo">Page 1</span>
                        <button class="btn btn-sm btn-outline-secondary ms-2" id="weighableNextPage" disabled>
                          <i class="fas fa-chevron-right"></i>
                        </button>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Unit-Based Goods Tab -->
                <div class="tab-pane fade" id="unit" role="tabpanel">
                  <h5 class="mb-2">Unit-Based Goods Inventory</h5>
                  <p class="text-sm text-secondary mb-3">Manage Items sold by Unit Quantity</p>
                  <div class="table-responsive p-0">
                    <table class="table align-items-center mb-0">
                      <thead>
                        <tr>
                          <th>Item</th>
                          <th>Available Quantity</th>
                          <th>Base Unit</th>
                          <th>Selling Price/Unit</th>
                          <th>Status</th>
                          <th>Action</th>
                        </tr>
                      </thead>
                      <tbody id="unitItemsTableBody"></tbody>
                    </table>
                    <div class="d-flex justify-content-between align-items-center mt-3 px-4" id="unitPaginationControls">
                      <div class="text-sm text-muted">
                        Showing <span id="unitStartRecord">0</span> to <span id="unitEndRecord">0</span> of <span id="unitTotalRecords">0</span> items
                      </div>
                      <div class="d-flex align-items-center">
                        <button class="btn btn-sm btn-outline-secondary me-2" id="unitPrevPage" disabled>
                          <i class="fas fa-chevron-left"></i>
                        </button>
                        <span class="badge bg-primary px-3 py-2" id="unitCurrentPageInfo">Page 1</span>
                        <button class="btn btn-sm btn-outline-secondary ms-2" id="unitNextPage" disabled>
                          <i class="fas fa-chevron-right"></i>
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Inventory Items Section (Secondary) -->
      <div class="row">
        <div class="col-12">
          <div class="card mb-4">
            <div class="card-header pb-0">
              <h4>Secondary Inventory</h4>
              <p class="text-sm text-secondary mb-0">Manage your store's secondary inventory items and stock levels</p>
            </div>
            <div class="card-body">
              <!-- Action Buttons -->
              <div class="row mb-4">
                <div class="col-12 col-md-6">
                  <button class="btn bg-gradient-primary w-100 w-md-auto" data-bs-toggle="modal" data-bs-target="">
                    <i class="fas fa-plus me-2"></i>Track New Stock
                  </button>
                </div>
                <div class="col-12 col-md-6 mt-2 mt-md-0">
                  <div class="d-flex flex-column flex-md-row gap-2">
                    <div class="input-group input-group-outline" style="height: 45px;">
                      <span class="input-group-text"><i class="fas fa-search"></i></span>
                      <input type="text" class="form-control" placeholder="Search Item">
                    </div>
                    <button class="btn bg-gradient-secondary" id="exportSecondaryInventoryBtn">
                      <i class="fas fa-file-export me-2"></i>Export
                    </button>
                  </div>
                </div>
              </div>

              <!-- Category Selection -->
              <div class="row mb-4">
                <div class="col-12">
                  <div class="nav-wrapper position-relative end-0">
                    <ul class="nav nav-pills nav-fill p-1" role="tablist">
                      <li class="nav-item">
                        <a class="nav-link mb-0 px-0 py-1 active" data-bs-toggle="tab" href="#secondaryWeighable" role="tab" aria-controls="secondaryWeighable" aria-selected="true">
                          <span class="ms-1">Weighable Goods</span>
                        </a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link mb-0 px-0 py-1" data-bs-toggle="tab" href="#secondaryUnit" role="tab" aria-controls="secondaryUnit" aria-selected="false">
                          <span class="ms-1">Unit-Based Goods</span>
                        </a>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>

              <!-- Tab Content -->
              <div class="tab-content">
                <!-- Weighable Goods Tab -->
                <div class="tab-pane fade show active" id="secondaryWeighable" role="tabpanel">
                  <h5 class="mb-2">Weighable Goods Inventory</h5>
                  <p class="text-sm text-secondary mb-3">Manage Items sold by weight</p>
                  <div class="table-responsive p-0">
                    <table class="table align-items-center mb-0">
                      <thead>
                        <tr>
                          <th>Item</th>
                          <th>Available Quantity</th>
                          <th>Base Unit</th>
                          <th>Adjustment Date</th>
                          <th>Action</th>
                        </tr>
                      </thead>
                      <tbody id="secondaryWeighableItemsTableBody"></tbody>
                    </table>
                    <div class="d-flex justify-content-between align-items-center mt-3 px-4" id="secondaryWeighablePaginationControls">
                      <div class="text-sm text-muted">
                        Showing <span id="secondaryWeighableStartRecord">0</span> to <span id="secondaryWeighableEndRecord">0</span> of <span id="secondaryWeighableTotalRecords">0</span> items
                      </div>
                      <div class="d-flex align-items-center">
                        <button class="btn btn-sm btn-outline-secondary me-2" id="secondaryWeighablePrevPage" disabled>
                          <i class="fas fa-chevron-left"></i>
                        </button>
                        <span class="badge bg-primary px-3 py-2" id="secondaryWeighableCurrentPageInfo">Page 1</span>
                        <button class="btn btn-sm btn-outline-secondary ms-2" id="secondaryWeighableNextPage" disabled>
                          <i class="fas fa-chevron-right"></i>
                        </button>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Unit-Based Goods Tab -->
                <div class="tab-pane fade" id="secondaryUnit" role="tabpanel">
                  <h5 class="mb-2">Unit-Based Goods Inventory</h5>
                  <p class="text-sm text-secondary mb-3">Manage Items sold by Unit Quantity</p>
                  <div class="table-responsive p-0">
                    <table class="table align-items-center mb-0">
                      <thead>
                        <tr>
                          <th>Item</th>
                          <th>Available Quantity</th>
                          <th>Base Unit</th>
                          <th>Adjustment Date</th>
                          <th>Action</th>
                        </tr>
                      </thead>
                      <tbody id="secondaryUnitItemsTableBody"></tbody>
                    </table>
                    <div class="d-flex justify-content-between align-items-center mt-3 px-4" id="secondaryUnitPaginationControls">
                      <div class="text-sm text-muted">
                        Showing <span id="secondaryUnitStartRecord">0</span> to <span id="secondaryUnitEndRecord">0</span> of <span id="secondaryUnitTotalRecords">0</span> items
                      </div>
                      <div class="d-flex align-items-center">
                        <button class="btn btn-sm btn-outline-secondary me-2" id="secondaryUnitPrevPage" disabled>
                          <i class="fas fa-chevron-left"></i>
                        </button>
                        <span class="badge bg-primary px-3 py-2" id="secondaryUnitCurrentPageInfo">Page 1</span>
                        <button class="btn btn-sm btn-outline-secondary ms-2" id="secondaryUnitNextPage" disabled>
                          <i class="fas fa-chevron-right"></i>
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Request Statistics Section -->
      <div class="row mt-4">
        <div class="col-12">
          <div class="card mb-4">
            <div class="card-header pb-0">
              <h4>Request Statistics</h4>
            </div>
            <div class="card-body">
              <div class="row">
                <!-- Request Details Card -->
                <div class="col-lg-6 mb-4">
                  <div class="card h-100">
                    <div class="card-header pb-0">
                      <div class="row">
                        <div class="col-6">
                          <h5 class="mb-0">Request Details</h5>
                </div>
                        <div class="col-6 text-end">
                          <div class="dropdown">
                            <button class="btn bg-gradient-secondary dropdown-toggle" type="button" id="periodDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                              Select Period
                            </button>
                            <ul class="dropdown-menu" aria-labelledby="periodDropdown">
                              <li><a class="dropdown-item" href="#">Last 7 Days</a></li>
                              <li><a class="dropdown-item" href="#">Last 30 Days</a></li>
                              <li><a class="dropdown-item" href="#">Last 90 Days</a></li>
                            </ul>
              </div>
            </div>
                  </div>
                </div>
                    <div class="card-body">
                      <div class="row text-center mb-4">
                        <div class="col-12">
                          <h2 class="mb-0" id="total-commodity-requests">24</h2>
                          <p class="text-sm text-secondary mb-0">Total Requests</p>
                  </div>
                </div>
                      <div class="row">
                        <div class="col-4 text-center">
                          <div class="card bg-gradient-info">
                            <div class="card-body p-2">
                              <h3 class="mb-0 text-white" id="pending-commodity-requests">8</h3>
                              <p class="text-sm text-white mb-0">Pending</p>
              </div>
                          </div>
                        </div>
                        <div class="col-4 text-center">
                          <div class="card bg-gradient-success">
                            <div class="card-body p-2">
                              <h3 class="mb-0 text-white" id="approved-commodity-requests">12</h3>
                              <p class="text-sm text-white mb-0">Approved</p>
                            </div>
                          </div>
                        </div>
                        <div class="col-4 text-center">
                          <div class="card bg-gradient-danger">
                            <div class="card-body p-2">
                              <h3 class="mb-0 text-white" id="rejected-commodity-requests">4</h3>
                              <p class="text-sm text-white mb-0">Rejected</p>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Top Requested Items Card -->
                <div class="col-lg-6 mb-4">
                  <div class="card h-100">
                    <div class="card-header pb-0">
                      <h5 class="mb-0">Top Requested Items</h5>
                    </div>
                    <div class="card-body">
                      <div class="table-responsive p-0">
                <table class="table align-items-center mb-0">
                  <thead>
                    <tr>
                              <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Item</th>
                              <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Period</th>
                    </tr>
                  </thead>
                  <tbody id="topRequestedItemsTableBody">
                    <!-- Top requested items will be dynamically added here -->
                  </tbody>
                </table>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
  <!-- Core JS Files -->
  <script src="../../assets/js/core/popper.min.js"></script>
  <script src="../../assets/js/core/bootstrap.min.js"></script>
  <script src="../../assets/js/plugins/perfect-scrollbar.min.js"></script>
  <script src="../../assets/js/plugins/smooth-scrollbar.min.js"></script>
  <script src="../../assets/js/plugins/chartjs.min.js"></script>
  <script>
    var win = navigator.platform.indexOf('Win') > -1;
    if (win && document.querySelector('#sidenav-scrollbar')) {
      var options = {
        damping: '0.5'
      }
      Scrollbar.init(document.querySelector('#sidenav-scrollbar'), options);
    }
  </script>
  <!-- Github buttons -->
  <script async defer src="https://buttons.github.io/buttons.js"></script>
  <!-- Control Center for Soft Dashboard -->
  <script src="../../assets/js/soft-ui-dashboard.min.js?v=1.1.0"></script>

  <!-- Custom CSS for Item Dropdowns -->
  <style>
    .item-dropdown-container {
      position: absolute;
      z-index: 9999;
      background: white;
      border: 1px solid #ddd;
      border-radius: 0.375rem;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      max-height: 200px;
      overflow-y: auto;
      min-width: 100%;
      margin-top: 5px;
    }
    
    .dropdown-item {
      cursor: pointer;
      transition: background-color 0.2s;
    }
    
    .dropdown-item:hover {
      background-color: #f8f9fa;
    }
    
    .dropdown-item:active {
      background-color: #e9ecef;
    }
    
    .input-group-sm .form-control {
      font-size: 0.875rem;
    }
    
    .position-relative {
      position: relative;
    }
    
    /* Ensure dropdown appears above other elements */
    .modal-body {
      overflow: visible;
    }
    
    .table-responsive {
      overflow: visible;
    }
    
    /* Custom scrollbar for dropdown */
    .item-dropdown-container::-webkit-scrollbar {
      width: 6px;
    }
    
    .item-dropdown-container::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 3px;
    }
    
    .item-dropdown-container::-webkit-scrollbar-thumb {
      background: #c1c1c1;
      border-radius: 3px;
    }
    
    .item-dropdown-container::-webkit-scrollbar-thumb:hover {
      background: #a8a8a8;
    }
  </style>

  <!-- Add New Sale Modal -->
  <div class="modal fade" id="addNewSaleModal" tabindex="-1" aria-labelledby="addNewSaleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <!-- Modal Header -->
        <div class="modal-header">
          <h5 class="modal-title" id="addNewSaleModalLabel">
            <i class="fas fa-plus-circle me-2 text-primary"></i>Add New Sale
          </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        
        <!-- Modal Body -->
        <div class="modal-body">
          <!-- Customer Section -->
          <div class="row mb-4">
            <div class="col-12">
              <div class="card">
                <div class="card-header pb-2">
                  <h6 class="mb-0">
                    <i class="fas fa-user me-2 text-info"></i>Customer Information
                  </h6>
                </div>
                <div class="card-body">
                  <div class="row">
                    <div class="col-md-8">
                      <div class="form-group">
                        <label class="form-control-label">Customer</label>
                        <div class="d-flex">
                          <div class="input-group me-2">
                            <span class="input-group-text">
                              <i class="fas fa-user"></i>
                            </span>
                            <select class="form-control" id="customerType" onchange="onCustomerTypeChange()">
                              <option value="">Select customer type</option>
                              <option value="Male">Male</option>
                              <option value="Female">Female</option>
                              <option value="Custom">Enter name</option>
                            </select>
                          </div>
                        </div>
                        <!-- Custom name input (hidden by default) -->
                        <div id="customNameSection" style="display: none;" class="mt-2">
                          <input type="text" class="form-control" id="customCustomerName" placeholder="Enter customer name">
                        </div>
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group">
                        <label class="form-control-label">Date</label>
                        <input type="date" class="form-control" id="saleDate">
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Payment Details Section -->
          <div class="row mb-4">
            <div class="col-12">
              <div class="card">
                <div class="card-header pb-2">
                  <h6 class="mb-0">
                    <i class="fas fa-credit-card me-2 text-success"></i>Payment Details
                  </h6>
                </div>
                <div class="card-body">
                  <div class="row">
                    <div class="col-md-6">
                      <div class="form-group">
                        <label class="form-control-label">Payment Method</label>
                        <select class="form-control" id="paymentMethod">
                          <option value="">Select payment method</option>
                        </select>
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <label class="form-control-label">Total Amount</label>
                        <div class="input-group">
                          <span class="input-group-text">$</span>
                          <input type="text" class="form-control" id="totalAmount" value="0.00" readonly>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Items Container -->
          <div class="row mb-4">
            <div class="col-12">
              <div class="card">
                <div class="card-header pb-2">
                  <div class="d-flex justify-content-between align-items-center">
                    <h6 class="mb-0">
                      <i class="fas fa-shopping-cart me-2 text-warning"></i>Items
                    </h6>
                    <button type="button" class="btn btn-primary btn-sm" onclick="addNewItemRow()">
                      <i class="fas fa-plus me-2"></i>Add Item
                    </button>
                  </div>
                </div>
                <div class="card-body">
                  <div class="table-responsive">
                    <table class="table align-items-center mb-0" id="itemsTable">
                      <thead>
                        <tr>
                          <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Item Name</th>
                          <th class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7 ps-2">Quantity</th>
                          <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Unit Price</th>
                          <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Total Price</th>
                          <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Discount</th>
                          <th class="text-center text-uppercase text-secondary text-xxs font-weight-bolder opacity-7">Action</th>
                        </tr>
                      </thead>
                      <tbody id="itemsTableBody">
                        <!-- Items will be added here dynamically -->
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Modal Footer -->
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
            <i class="fas fa-times me-2"></i>Cancel
          </button>
          <button type="button" class="btn btn-primary" onclick="saveSale()">
            <i class="fas fa-save me-2"></i>Save Sale
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Reorder Stock Modal -->
  <div class="modal fade" id="reorderStockModal" tabindex="-1" aria-labelledby="reorderStockModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <!-- Modal Header -->
        <div class="modal-header">
          <h5 class="modal-title" id="reorderStockModalLabel">
            <i class="fas fa-boxes me-2 text-warning"></i>Reorder Stock
          </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <!-- Modal Body -->
        <div class="modal-body">
          <!-- Section 1: Item Information -->
          <div class="card mb-4">
            <div class="card-header pb-2">
              <h6 class="mb-0"><i class="fas fa-info-circle me-2 text-info"></i>Item Information</h6>
            </div>
            <div class="card-body">
              <div class="form-group mb-3">
                <label class="form-control-label">Item Name</label>
                <input type="text" class="form-control" id="reorderItemName" placeholder="Enter item name" oninput="onReorderItemNameInput()">
              </div>
              <div class="row">
                <div class="col-md-4">
                  <div class="form-group mb-3">
                    <label class="form-control-label">Category</label>
                    <select class="form-control" id="reorderItemCategory">
                      <option value="">Select category</option>
                      <option value="grocery">Grocery</option>
                      <option value="electronics">Electronics</option>
                      <option value="apparel">Apparel</option>
                    </select>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="form-group mb-3">
                    <label class="form-control-label">Item Type</label>
                    <select class="form-control" id="reorderItemType" onchange="onReorderItemTypeChange()">
                      <option value="weighable">Weighable</option>
                      <option value="unit_based">Unit-based</option>
                    </select>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="form-group mb-3">
                    <label class="form-control-label">Base Unit of Measure</label>
                    <select class="form-control" id="reorderItemBaseUnit" onchange="calculateReorderTotalUnits()">
                      <option value="kg">kg</option>
                      <option value="pcs">pcs</option>
                      <option value="l">l</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Current Stock Display -->
          <div class="alert alert-info mb-4" id="reorderCurrentStockDisplay" style="display:none;">
            <strong>Current Stock:</strong> <span id="reorderCurrentStockValue">0</span>
          </div>

          <!-- Supplier Information Section -->
          <div class="card mb-4">
            <div class="card-header pb-2">
              <h6 class="mb-0">
                <i class="fas fa-truck me-2 text-success"></i>Supplier Information
              </h6>
            </div>
            <div class="card-body">
                <div class="form-group">
                  <label class="form-control-label">Supplier</label>
                  <select class="form-control" id="reorderItemSupplier">
                    <option value="">Select supplier</option>
                    <option value="supplier1">ABC Suppliers</option>
                    <option value="supplier2">XYZ Trading Co.</option>
                  </select>
                </div>
            </div>
          </div>

          <!-- Section 2: Packaging & Stock Details -->
          <div class="card mb-4">
            <div class="card-header pb-2">
              <h6 class="mb-0"><i class="fas fa-box-open me-2 text-warning"></i>Packaging & Stock Details</h6>
            </div>
            <div class="card-body">
              <!-- Weighable Item Fields -->
              <div id="reorderWeighableFields">
                <div class="row">
                  <div class="col-md-4">
                    <div class="form-group mb-3">
                      <label class="form-control-label">Package Unit</label>
                      <input type="text" class="form-control" id="reorderWeighablePackageUnit" placeholder="e.g., Sack">
                    </div>
                  </div>
                  <div class="col-md-4">
                    <div class="form-group mb-3">
                      <label class="form-control-label">Weight per Package (kg)</label>
                      <input type="number" class="form-control" id="reorderWeighableWeightPerPackage" placeholder="e.g., 50" oninput="calculateReorderTotalWeight()">
                    </div>
                  </div>
                  <div class="col-md-4">
                    <div class="form-group mb-3">
                      <label class="form-control-label">Initial No. of Packages</label>
                      <input type="number" class="form-control" id="reorderWeighableInitialPackages" placeholder="e.g., 12" oninput="calculateReorderTotalWeight()">
                    </div>
                  </div>
                </div>
                <div class="form-group mb-3">
                  <label class="form-control-label">Total Weight (Auto-Calculated)</label>
                  <input type="text" class="form-control" id="reorderWeighableTotalWeight" placeholder="600 kg" disabled>
                </div>
              </div>

              <!-- Unit-based Item Fields -->
              <div id="reorderUnitBasedFields" style="display: none;">
                <div class="row">
                  <div class="col-md-4">
                    <div class="form-group mb-3">
                      <label class="form-control-label">Package Unit</label>
                      <input type="text" class="form-control" id="reorderUnitPackageUnit" placeholder="e.g., Box">
                    </div>
                  </div>
                  <div class="col-md-4">
                    <div class="form-group mb-3">
                      <label class="form-control-label">Units per Package</label>
                      <input type="number" class="form-control" id="reorderUnitUnitsPerPackage" placeholder="e.g., 10" oninput="calculateReorderTotalUnits()">
                    </div>
                  </div>
                  <div class="col-md-4">
                    <div class="form-group mb-3">
                      <label class="form-control-label">Initial No. of Packages</label>
                      <input type="number" class="form-control" id="reorderUnitInitialPackages" placeholder="e.g., 10" oninput="calculateReorderTotalUnits()">
                    </div>
                  </div>
                </div>
                <div class="form-group mb-3">
                  <label class="form-control-label">Total Units (Auto-Calculated)</label>
                  <input type="text" class="form-control" id="reorderUnitTotalUnits" placeholder="100 bars" disabled>
                </div>
              </div>
              
              <hr class="horizontal dark">

              <div class="row">
                  <div class="col-md-6">
                      <div class="form-group mb-3">
                          <label class="form-control-label">Expiry Date</label>
                          <input type="date" class="form-control" id="reorderExpiryDate">
                      </div>
                  </div>
                  <div class="col-md-6">
                      <div class="form-group mb-3">
                          <label class="form-control-label">Minimum Stock Alert</label>
                          <input type="number" class="form-control" id="reorderMinStock" placeholder="Enter minimum stock level">
                      </div>
                  </div>
              </div>
            </div>
          </div>

          <!-- Section 3: Pricing -->
          <div class="card">
            <div class="card-header pb-2">
                <h6 class="mb-0"><i class="fas fa-dollar-sign me-2 text-primary"></i>Pricing</h6>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group mb-3">
                            <label class="form-control-label">Purchase Price per Package</label>
                            <div class="input-group">
                                <span class="input-group-text">$</span>
                                <input type="number" class="form-control" id="reorderPurchasePrice" placeholder="e.g., 50" oninput="calculateReorderTotalCost()">
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group mb-3">
                            <label class="form-control-label">Selling Price per Unit</label>
                             <div class="input-group">
                                <span class="input-group-text">$</span>
                                <input type="number" class="form-control" id="reorderSellingPrice" placeholder="e.g., 0.5 or 1" oninput="calculateReorderTotalRevenue()">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-group mb-3">
                    <label class="form-control-label">Total Cost (Auto-Calculated)</label>
                    <div class="input-group">
                        <span class="input-group-text">$</span>
                        <input type="text" class="form-control" id="reorderTotalCost" placeholder="e.g., 600" disabled>
                    </div>
                </div>
                <div class="form-group mb-3">
                    <label class="form-control-label">Total Revenue (Auto-Calculated)</label>
                    <div class="input-group">
                        <span class="input-group-text">$</span>
                        <input type="text" class="form-control" id="reorderTotalRevenue" placeholder="e.g., 750" disabled>
                    </div>
                </div>
            </div>
          </div>
        </div>
        <!-- Modal Footer -->
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary" onclick="confirmReorder()">Save Reorder</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Add New Item Modal -->
  <div class="modal fade" id="addNewItemModal" tabindex="-1" aria-labelledby="addNewItemModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <!-- Modal Header -->
        <div class="modal-header">
          <h5 class="modal-title" id="addNewItemModalLabel">
            <i class="fas fa-boxes me-2 text-primary"></i>Add New Item
          </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <!-- Modal Body -->
        <div class="modal-body">
          <form id="addNewItemForm">
            <!-- Section 1: Item Information -->
            <div class="card mb-4">
              <div class="card-header pb-2">
                <h6 class="mb-0"><i class="fas fa-info-circle me-2 text-info"></i>Item Information</h6>
              </div>
              <div class="card-body">
                <div class="form-group mb-3">
                  <label class="form-control-label">Item Name</label>
                  <input type="text" class="form-control" name="name" id="addItemName" placeholder="Enter item name">
                </div>
                <div class="row">
                  <div class="col-md-4">
                    <div class="form-group mb-3">
                      <label class="form-control-label">Category</label>
                      <select class="form-control" name="category_id" id="addItemCategory" required>
                        <option value="">Select category...</option>
                        <!-- Categories will be populated here by JavaScript -->
                      </select>
                    </div>
                  </div>
                  <div class="col-md-4">
                    <div class="form-group mb-3">
                      <label class="form-control-label">Item Type</label>
                      <select class="form-control" name="item_type" id="addItemType">
                        <option value="weighable">Weighable</option>
                        <option value="unit_based">Unit-based</option>
                      </select>
                    </div>
                  </div>
                  <div class="col-md-4">
                    <div class="form-group mb-3">
                      <label class="form-control-label">Base Unit of Measure</label>
                      <select class="form-control" name="base_unit" id="addItemBaseUnit">
                        <option value="kg">kg</option>
                        <option value="pcs">pcs</option>
                        <option value="l">l</option>
                      </select>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Supplier Information Section -->
            <div class="card mb-4">
              <div class="card-header pb-2">
                <h6 class="mb-0">
                  <i class="fas fa-truck me-2 text-success"></i>Supplier Information
                </h6>
              </div>
              <div class="card-body">
                <div class="row">
                  <div class="col-md-6">
                    <div class="form-group mb-3">
                      <label class="form-control-label">Supplier Name</label>
                      <input type="text" class="form-control" name="supplier_name" id="addSupplierName" placeholder="Enter supplier's name">
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group mb-3">
                      <label class="form-control-label">Supplier Contact</label>
                      <input type="text" class="form-control" name="supplier_contact" id="addSupplierContact" placeholder="Enter supplier's contact info">
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Section 2: Packaging & Stock Details -->
            <div class="card mb-4">
              <div class="card-header pb-2">
                <h6 class="mb-0"><i class="fas fa-box-open me-2 text-warning"></i>Packaging & Stock Details</h6>
              </div>
              <div class="card-body">
                <!-- Weighable Item Fields -->
                <div id="weighableFields">
                  <div class="row">
                    <div class="col-md-4">
                      <div class="form-group mb-3">
                        <label class="form-control-label">Package Unit</label>
                        <input type="text" class="form-control" name="package_unit" id="weighablePackageUnit" placeholder="e.g., Sack">
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group mb-3">
                        <label class="form-control-label">Weight per Package (kg)</label>
                        <input type="number" class="form-control" name="weight_per_package" id="weighableWeightPerPackage" placeholder="e.g., 50">
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group mb-3">
                        <label class="form-control-label">Initial No. of Packages</label>
                        <input type="number" class="form-control" name="initial_packages" id="weighableInitialPackages" placeholder="e.g., 12">
                      </div>
                    </div>
                  </div>
                  <div class="form-group mb-3">
                    <label class="form-control-label">Total Weight (Auto-Calculated)</label>
                    <input type="text" class="form-control" id="weighableTotalWeight" placeholder="600 kg" disabled>
                  </div>
                </div>

                <!-- Unit-based Item Fields -->
                <div id="unitBasedFields" style="display: none;">
                  <div class="row">
                    <div class="col-md-4">
                      <div class="form-group mb-3">
                        <label class="form-control-label">Package Unit</label>
                        <input type="text" class="form-control" name="package_unit" id="unitPackageUnit" placeholder="e.g., Box">
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group mb-3">
                        <label class="form-control-label">Units per Package</label>
                        <input type="number" class="form-control" name="units_per_package" id="unitUnitsPerPackage" placeholder="e.g., 10">
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group mb-3">
                        <label class="form-control-label">Initial No. of Packages</label>
                        <input type="number" class="form-control" name="initial_packages" id="unitInitialPackages" placeholder="e.g., 10">
                      </div>
                    </div>
                  </div>
                  <div class="form-group mb-3">
                    <label class="form-control-label">Total Units (Auto-Calculated)</label>
                    <input type="text" class="form-control" id="unitTotalUnits" placeholder="100 bars" disabled>
                  </div>
                </div>
                
                <hr class="horizontal dark">

                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group mb-3">
                            <label class="form-control-label">Expiry Date</label>
                            <input type="date" class="form-control" name="expiry_date" id="addItemExpiryDate">
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group mb-3">
                            <label class="form-control-label">Minimum Stock Alert</label>
                            <input type="number" class="form-control" name="minimum_stock" id="addItemMinStock" placeholder="Enter minimum stock level">
                        </div>
                    </div>
                </div>
              </div>
            </div>

            <!-- Section 3: Pricing -->
            <div class="card">
              <div class="card-header pb-2">
                  <h6 class="mb-0"><i class="fas fa-dollar-sign me-2 text-primary"></i>Pricing</h6>
              </div>
              <div class="card-body">
                  <div class="row">
                      <div class="col-md-6">
                          <div class="form-group mb-3">
                              <label class="form-control-label">Purchase Price per Package</label>
                              <div class="input-group">
                                  <span class="input-group-text">$</span>
                                  <input type="number" class="form-control" name="purchase_price_per_package" id="addItemPurchasePrice" placeholder="e.g., 50">
                              </div>
                          </div>
                      </div>
                      <div class="col-md-6">
                          <div class="form-group mb-3">
                              <label class="form-control-label">Selling Price per Unit</label>
                               <div class="input-group">
                                  <span class="input-group-text">$</span>
                                  <input type="number" class="form-control" name="selling_price_per_unit" id="addItemSellingPrice" placeholder="e.g., 0.5 or 1">
                              </div>
                          </div>
                      </div>
                  </div>
                  <div class="form-group mb-3">
                      <label class="form-control-label">Total Cost (Auto-Calculated)</label>
                      <div class="input-group">
                          <span class="input-group-text">$</span>
                          <input type="text" class="form-control" id="addItemTotalCost" placeholder="e.g., 600" disabled>
                      </div>
                  </div>
                  <div class="form-group mb-3">
                      <label class="form-control-label">Total Revenue (Auto-Calculated)</label>
                      <div class="input-group">
                          <span class="input-group-text">$</span>
                          <input type="text" class="form-control" id="addItemTotalRevenue" placeholder="e.g., 750" disabled>
                      </div>
                  </div>
              </div>
            </div>
          </form>
        </div>
        <!-- Modal Footer -->
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="submit" form="addNewItemForm" class="btn btn-primary">Save Item</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Update Item Modal (clone of Add New Item Modal, but for updating) -->
  <div class="modal fade" id="updateItemModal" tabindex="-1" aria-labelledby="updateItemModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="updateItemModalLabel">
            <i class="fas fa-edit me-2 text-primary"></i>Update Item
          </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="updateItemForm">
            <!-- Section 1: Item Information -->
            <div class="card mb-4">
              <div class="card-header pb-2">
                <h6 class="mb-0"><i class="fas fa-info-circle me-2 text-info"></i>Item Information</h6>
              </div>
              <div class="card-body">
                <div class="form-group mb-3">
                  <label class="form-control-label">Item Name</label>
                  <input type="text" class="form-control" name="name" id="updateItemName" placeholder="Enter item name">
                </div>
                <div class="row">
                  <div class="col-md-4">
                    <div class="form-group mb-3">
                      <label class="form-control-label">Category</label>
                      <select class="form-control" name="category_id" id="updateItemCategory" required>
                        <option value="">Select category...</option>
                      </select>
                    </div>
                  </div>
                  <div class="col-md-4">
                    <div class="form-group mb-3">
                      <label class="form-control-label">Item Type</label>
                      <select class="form-control" name="item_type" id="updateItemType">
                        <option value="weighable">Weighable</option>
                        <option value="unit_based">Unit-based</option>
                      </select>
                    </div>
                  </div>
                  <div class="col-md-4">
                    <div class="form-group mb-3">
                      <label class="form-control-label">Base Unit of Measure</label>
                      <select class="form-control" name="base_unit" id="updateItemBaseUnit">
                        <option value="kg">kg</option>
                        <option value="pcs">pcs</option>
                        <option value="l">l</option>
                      </select>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- Supplier Information Section -->
            <div class="card mb-4">
              <div class="card-header pb-2">
                <h6 class="mb-0">
                  <i class="fas fa-truck me-2 text-success"></i>Supplier Information
                </h6>
              </div>
              <div class="card-body">
                <div class="row">
                  <div class="col-md-6">
                    <div class="form-group mb-3">
                      <label class="form-control-label">Supplier Name</label>
                      <input type="text" class="form-control" name="supplier_name" id="updateSupplierName" placeholder="Enter supplier's name">
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group mb-3">
                      <label class="form-control-label">Supplier Contact</label>
                      <input type="text" class="form-control" name="supplier_contact" id="updateSupplierContact" placeholder="Enter supplier's contact info">
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- Section 2: Packaging & Stock Details -->
            <div class="card mb-4">
              <div class="card-header pb-2">
                <h6 class="mb-0"><i class="fas fa-box-open me-2 text-warning"></i>Packaging & Stock Details</h6>
              </div>
              <div class="card-body">
                <div id="updateWeighableFields">
                  <div class="row">
                    <div class="col-md-4">
                      <div class="form-group mb-3">
                        <label class="form-control-label">Package Unit</label>
                        <input type="text" class="form-control" name="package_unit" id="updateWeighablePackageUnit" placeholder="e.g., Sack">
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group mb-3">
                        <label class="form-control-label">Weight per Package (kg)</label>
                        <input type="number" class="form-control" name="weight_per_package" id="updateWeighableWeightPerPackage" placeholder="e.g., 50">
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group mb-3">
                        <label class="form-control-label">Initial No. of Packages</label>
                        <input type="number" class="form-control" name="initial_packages" id="updateWeighableInitialPackages" placeholder="e.g., 12">
                      </div>
                    </div>
                  </div>
                  <div class="form-group mb-3">
                    <label class="form-control-label">Total Weight (Auto-Calculated)</label>
                    <input type="text" class="form-control" id="updateWeighableTotalWeight" placeholder="600 kg" disabled>
                  </div>
                </div>
                <div id="updateUnitBasedFields" style="display: none;">
                  <div class="row">
                    <div class="col-md-4">
                      <div class="form-group mb-3">
                        <label class="form-control-label">Package Unit</label>
                        <input type="text" class="form-control" name="package_unit" id="updateUnitPackageUnit" placeholder="e.g., Box">
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group mb-3">
                        <label class="form-control-label">Units per Package</label>
                        <input type="number" class="form-control" name="units_per_package" id="updateUnitUnitsPerPackage" placeholder="e.g., 10">
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group mb-3">
                        <label class="form-control-label">Initial No. of Packages</label>
                        <input type="number" class="form-control" name="initial_packages" id="updateUnitInitialPackages" placeholder="e.g., 10">
                      </div>
                    </div>
                  </div>
                  <div class="form-group mb-3">
                    <label class="form-control-label">Total Units (Auto-Calculated)</label>
                    <input type="text" class="form-control" id="updateUnitTotalUnits" placeholder="100 bars" disabled>
                  </div>
                </div>
                <hr class="horizontal dark">
                <div class="row">
                  <div class="col-md-6">
                    <div class="form-group mb-3">
                      <label class="form-control-label">Expiry Date</label>
                      <input type="date" class="form-control" name="expiry_date" id="updateItemExpiryDate">
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group mb-3">
                      <label class="form-control-label">Minimum Stock Alert</label>
                      <input type="number" class="form-control" name="minimum_stock" id="updateItemMinStock" placeholder="Enter minimum stock level">
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- Section 3: Pricing -->
            <div class="card">
              <div class="card-header pb-2">
                <h6 class="mb-0"><i class="fas fa-dollar-sign me-2 text-primary"></i>Pricing</h6>
              </div>
              <div class="card-body">
                <div class="row">
                  <div class="col-md-6">
                    <div class="form-group mb-3">
                      <label class="form-control-label">Purchase Price per Package</label>
                      <div class="input-group">
                        <span class="input-group-text">$</span>
                        <input type="number" class="form-control" name="purchase_price_per_package" id="updateItemPurchasePrice" placeholder="e.g., 50">
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group mb-3">
                      <label class="form-control-label">Selling Price per Unit</label>
                      <div class="input-group">
                        <span class="input-group-text">$</span>
                        <input type="number" class="form-control" name="selling_price_per_unit" id="updateItemSellingPrice" placeholder="e.g., 0.5 or 1">
                      </div>
                    </div>
                  </div>
                </div>
                <div class="form-group mb-3">
                  <label class="form-control-label">Total Cost (Auto-Calculated)</label>
                  <div class="input-group">
                    <span class="input-group-text">$</span>
                    <input type="text" class="form-control" id="updateItemTotalCost" placeholder="e.g., 600" disabled>
                  </div>
                </div>
                <div class="form-group mb-3">
                  <label class="form-control-label">Total Revenue (Auto-Calculated)</label>
                  <div class="input-group">
                    <span class="input-group-text">$</span>
                    <input type="text" class="form-control" id="updateItemTotalRevenue" placeholder="e.g., 750" disabled>
                  </div>
                </div>
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="submit" form="updateItemForm" class="btn btn-primary">Update Item</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Add Edit Item Modal (clone of Update Item Modal, but for editing) -->
  <div class="modal fade" id="editItemModal" tabindex="-1" aria-labelledby="editItemModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="editItemModalLabel">
            <i class="fas fa-edit me-2 text-primary"></i>Edit Item
          </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="editItemForm">
            <!-- Section 1: Item Information -->
            <div class="card mb-4">
              <div class="card-header pb-2">
                <h6 class="mb-0"><i class="fas fa-info-circle me-2 text-info"></i>Item Information</h6>
              </div>
              <div class="card-body">
                <div class="form-group mb-3">
                  <label class="form-control-label">Item Name</label>
                  <input type="text" class="form-control" name="name" id="editItemName" placeholder="Enter item name">
                </div>
                <div class="row">
                  <div class="col-md-4">
                    <div class="form-group mb-3">
                      <label class="form-control-label">Category</label>
                      <select class="form-control" name="category_id" id="editItemCategory" required>
                        <option value="">Select category...</option>
                      </select>
                    </div>
                  </div>
                  <div class="col-md-4">
                    <div class="form-group mb-3">
                      <label class="form-control-label">Item Type</label>
                      <select class="form-control" name="item_type" id="editItemType">
                        <option value="weighable">Weighable</option>
                        <option value="unit_based">Unit-based</option>
                      </select>
                    </div>
                  </div>
                  <div class="col-md-4">
                    <div class="form-group mb-3">
                      <label class="form-control-label">Base Unit of Measure</label>
                      <select class="form-control" name="base_unit" id="editItemBaseUnit">
                        <option value="kg">kg</option>
                        <option value="pcs">pcs</option>
                        <option value="l">l</option>
                      </select>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- Supplier Information Section -->
            <div class="card mb-4">
              <div class="card-header pb-2">
                <h6 class="mb-0">
                  <i class="fas fa-truck me-2 text-success"></i>Supplier Information
                </h6>
              </div>
              <div class="card-body">
                <div class="row">
                  <div class="col-md-6">
                    <div class="form-group mb-3">
                      <label class="form-control-label">Supplier Name</label>
                      <input type="text" class="form-control" name="supplier_name" id="editSupplierName" placeholder="Enter supplier's name">
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group mb-3">
                      <label class="form-control-label">Supplier Contact</label>
                      <input type="text" class="form-control" name="supplier_contact" id="editSupplierContact" placeholder="Enter supplier's contact info">
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- Section 2: Packaging & Stock Details -->
            <div class="card mb-4">
              <div class="card-header pb-2">
                <h6 class="mb-0"><i class="fas fa-box-open me-2 text-warning"></i>Packaging & Stock Details</h6>
              </div>
              <div class="card-body">
                <div id="editWeighableFields">
                  <div class="row">
                    <div class="col-md-4">
                      <div class="form-group mb-3">
                        <label class="form-control-label">Package Unit</label>
                        <input type="text" class="form-control" name="package_unit" id="editWeighablePackageUnit" placeholder="e.g., Sack">
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group mb-3">
                        <label class="form-control-label">Weight per Package (kg)</label>
                        <input type="number" class="form-control" name="weight_per_package" id="editWeighableWeightPerPackage" placeholder="e.g., 50">
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group mb-3">
                        <label class="form-control-label">Initial No. of Packages</label>
                        <input type="number" class="form-control" name="initial_packages" id="editWeighableInitialPackages" placeholder="e.g., 12">
                      </div>
                    </div>
                  </div>
                  <div class="form-group mb-3">
                    <label class="form-control-label">Total Weight (Auto-Calculated)</label>
                    <input type="text" class="form-control" id="editWeighableTotalWeight" placeholder="600 kg" disabled>
                  </div>
                </div>
                <!-- Unit-based Item Fields -->
                <div id="editUnitBasedFields" style="display: none;">
                  <div class="row">
                    <div class="col-md-4">
                      <div class="form-group mb-3">
                        <label class="form-control-label">Package Unit</label>
                        <input type="text" class="form-control" name="package_unit" id="editUnitPackageUnit" placeholder="e.g., Box">
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group mb-3">
                        <label class="form-control-label">Units per Package</label>
                        <input type="number" class="form-control" name="units_per_package" id="editUnitUnitsPerPackage" placeholder="e.g., 10">
                      </div>
                    </div>
                    <div class="col-md-4">
                      <div class="form-group mb-3">
                        <label class="form-control-label">Initial No. of Packages</label>
                        <input type="number" class="form-control" name="initial_packages" id="editUnitInitialPackages" placeholder="e.g., 10">
                      </div>
                    </div>
                  </div>
                  <div class="form-group mb-3">
                    <label class="form-control-label">Total Units (Auto-Calculated)</label>
                    <input type="text" class="form-control" id="editUnitTotalUnits" placeholder="100 bars" disabled>
                  </div>
                </div>
                <hr class="horizontal dark">
                <div class="row">
                  <div class="col-md-6">
                    <div class="form-group mb-3">
                      <label class="form-control-label">Expiry Date</label>
                      <input type="date" class="form-control" name="expiry_date" id="editItemExpiryDate">
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group mb-3">
                      <label class="form-control-label">Minimum Stock Alert</label>
                      <input type="number" class="form-control" name="minimum_stock" id="editItemMinStock" placeholder="Enter minimum stock level">
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <!-- Section 3: Pricing -->
            <div class="card">
              <div class="card-header pb-2">
                <h6 class="mb-0"><i class="fas fa-dollar-sign me-2 text-primary"></i>Pricing</h6>
              </div>
              <div class="card-body">
                <div class="row">
                  <div class="col-md-6">
                    <div class="form-group mb-3">
                      <label class="form-control-label">Purchase Price per Package</label>
                      <div class="input-group">
                        <span class="input-group-text">$</span>
                        <input type="number" class="form-control" name="purchase_price_per_package" id="editItemPurchasePrice" placeholder="e.g., 50">
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group mb-3">
                      <label class="form-control-label">Selling Price per Unit</label>
                      <div class="input-group">
                        <span class="input-group-text">$</span>
                        <input type="number" class="form-control" name="selling_price_per_unit" id="editItemSellingPrice" placeholder="e.g., 0.5 or 1">
                      </div>
                    </div>
                  </div>
                </div>
                <div class="form-group mb-3">
                  <label class="form-control-label">Total Cost (Auto-Calculated)</label>
                  <div class="input-group">
                    <span class="input-group-text">$</span>
                    <input type="text" class="form-control" id="editItemTotalCost" placeholder="e.g., 600" disabled>
                  </div>
                </div>
                <div class="form-group mb-3">
                  <label class="form-control-label">Total Revenue (Auto-Calculated)</label>
                  <div class="input-group">
                    <span class="input-group-text">$</span>
                    <input type="text" class="form-control" id="editItemTotalRevenue" placeholder="e.g., 750" disabled>
                  </div>
                </div>
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="submit" form="editItemForm" class="btn btn-warning">Save Edit</button>
        </div>
      </div>
    </div>
  </div>

  <script src="sales.js?v=1.1"></script>
  <!-- Delete Sale Modal -->
  <div class="modal fade" id="deleteSaleModal" tabindex="-1" aria-labelledby="deleteSaleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="deleteSaleModalLabel"><i class="fas fa-trash-alt text-danger me-2"></i>Confirm Delete</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p>Are you sure you want to delete this sale? This will restore the item quantities involved.</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-danger" id="confirmDeleteSaleBtn">Delete</button>
        </div>
      </div>
    </div>
  </div>
  <!-- jsPDF and autoTable for PDF export -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.7.0/jspdf.plugin.autotable.min.js"></script>
  <!-- Delete Inventory Adjustment Modal -->
  <div class="modal fade" id="deleteAdjustmentModal" tabindex="-1" aria-labelledby="deleteAdjustmentModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="deleteAdjustmentModalLabel"><i class="fas fa-trash-alt text-danger me-2"></i>Confirm Delete</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p>Are you sure you want to delete this inventory adjustment? This action cannot be undone.</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-danger" id="confirmDeleteAdjustmentBtn">Delete</button>
        </div>
      </div>
    </div>
  </div>
  <script>
  document.getElementById('signOutLink').addEventListener('click', function(e) {
    e.preventDefault();
    localStorage.removeItem('authToken'); // Remove the token on sign out
    window.location.href = '../sign-in.html';
  });
  </script>
</body>

</html> 
